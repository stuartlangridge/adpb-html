<!DOCTYPE html>
<html lang="en">
<head>
		<title>as days pass by &mdash; RSS feeds with changing enclosure URLs</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<link rel="profile" href="http://gmpg.org/xfn/11" />
		<link href="https://fonts.googleapis.com/css?display=swap&family=Averia+Serif+Libre|Enriqueta:400,700" rel="stylesheet">
		<meta name="monetization" content="$pay.stronghold.co/1a198b49b9914f84e218d360b725bca1fd1">
		<meta name="Description" content="Stuart Langridge of Kryogenix Consulting, for consultancy and custom development on the web and devices">
        <meta property="og:title" content="as days pass by &mdash; RSS feeds with changing enclosure URLs">
        <meta property="og:type" content="website">
        <meta property="og:site_name" content="as days pass by">
        <meta property="og:description" content="A post by Stuart Langridge (sil)">
        <meta property="og:image" content="https://www.kryogenix.org/days/2005/07/10/enclosure/index.html.og_image.png">
        <meta name="twitter:card" content="summary_large_image">
        <meta name="twitter:site" content="@sil">
        <meta name="twitter:image" content="https://www.kryogenix.org/days/2005/07/10/enclosure/index.html.og_image.png">
		<link rel="stylesheet" type="text/css" href="https://www.kryogenix.org/days/theme/css/style.css" />
		<link rel="stylesheet" type="text/css" href="https://www.kryogenix.org/days/theme/css/simple-footnotes.css" />
		<link rel="icon" type="image/png" href="/favicon.png" />
		<style type="text/css">
			body.custom-background {
				background: url(https://www.kryogenix.org/days/theme/handmadepaper.png); /* thank you subtlepatterns! */
			}
		</style>
		<link rel="alternate" type="application/rss+xml"
			title="as days pass by"
			href="https://www.kryogenix.org/days/feed" /> 
		<!--[if lte IE 8]><script src="https://www.kryogenix.org/days/theme/js/html5shiv.js"></script><![endif]-->
		<link rel="webmention" href="https://webmention.herokuapp.com/api/webmention" />
		<link rel="feed" href="https://www.kryogenix.org/days/archives/"> 
		<script src="https://cdn.ravenjs.com/3.4.1/raven.min.js"></script>
		<script>Raven.config('https://fc8cd4c9637043f3b385d9daa8dbe367@app.getsentry.com/91852').install()</script>
</head>

<body class="home blog custom-background single-author" >
	<div id="container">
		<div id="header">
				<p>A blog by <a href="https://www.kryogenix.org/">Stuart Langridge</a></p>
				<h1 id="site-title"><a href="https://www.kryogenix.org/days">as days pass by</a></h1>
<h2 id="site-description">scratched tallies on the prison wall</h2>		</div><!-- /#banner -->
		
		<div id="menu">
			<div class="menu-navigation-container">
				<ul id="menu-navigation" class="menu">
						<li  class="active" class="menu-item menu-item-type-post_type menu-item-object-page"><a href="/">Kryogenix Consulting</a></li>
						<li  class="active" class="menu-item menu-item-type-post_type menu-item-object-page"><a href="/days/archives">All posts, ever</a></li>
						<li  class="active" class="menu-item menu-item-type-post_type menu-item-object-page"><a href="/code">Code</a></li>

				</ul>
			</div> <!--/#menu-navigation-container-->
		</div><!-- /#menu -->
		
		<div class="page-title">
		</div>
	
		<div id="contents">

<div class="post type-post status-publish format-standard hentry category-general h-entry" id="post">
	<div class="entry-meta">
		<div class="date"><a href="https://www.kryogenix.org/days/2005/07/10/enclosure/"><time 
			class="dt-published" datetime="2005-07-10T11:00:00+01:00">Jul 10 2005</time></a>
			<span class="byline h-card">By <a class="p-author" href="https://www.kryogenix.org/days/"><img src="https://kryogenix.org/images/hackergotchi-simpler.png" class="u-photo" alt=""> <span class="p-name">sil</span></a></span>
		</div>
	</div> <!-- /#entry-meta -->
	<div class="main">
		<h2 class="entry-title">
			<a class="u-url p-name" href="https://www.kryogenix.org/days/2005/07/10/enclosure/" title="Permalink to RSS feeds with changing enclosure URLs" rel="bookmark"><span class="caps">RSS</span> feeds with changing enclosure&nbsp;URLs</a>
		</h2>
		<div class="entry-content e-content">
			<p>On the LugRadio site we publish an <span class="caps"><span class="caps">RSS</span></span> feed of
episodes, and each episode includes an enclosure tag which references
the downloadable <span class="caps"><span class="caps">MP3</span></span> for that episode. So, one
snippet from the feed looks&nbsp;like:</p>
<div class="highlight"><pre><span></span><code><span class="nt">&lt;item&gt;</span>
<span class="w">    </span><span class="nt">&lt;title&gt;</span>Bars<span class="w"> </span>with<span class="w"> </span>coconut<span class="w"> </span>in<span class="nt">&lt;/title&gt;</span>
<span class="w">    </span><span class="nt">&lt;link&gt;</span>http://www.lugradio.org/episodes/31<span class="nt">&lt;/link&gt;</span>
<span class="w">    </span><span class="nt">&lt;description&gt;</span>Jono<span class="w"> </span>Bacon,<span class="w"> </span>Stuart<span class="w"> </span>Langridge<span class="w"> </span>(Aq),<span class="w"> </span>Matt<span class="w"> </span>Revell,<span class="w"> </span>and<span class="w"> </span><span class="ni">&amp;lt;</span>span<span class="w"> </span>title=<span class="ni">&amp;quot;</span>On<span class="w"> </span>Call
Bald<span class="ni">&amp;quot;</span>
style=<span class="ni">&amp;quot;</span>border-bottom:<span class="w"> </span>1px<span class="w"> </span>dotted<span class="w"> </span>#ccc<span class="ni">&amp;quot;&amp;gt;</span>Ade<span class="w"> </span>Bradshaw<span class="ni">&amp;lt;</span>/span<span class="ni">&amp;gt;</span>
talk<span class="w"> </span>about<span class="w"> </span>Linux<span class="w"> </span>and<span class="w"> </span>whatever<span class="w"> </span>else<span class="w"> </span>comes<span class="w"> </span>along,<span class="w"> </span>including:
<span class="ni">&amp;lt;</span>/p<span class="ni">&amp;gt;</span>
<span class="ni">&amp;lt;</span>ul<span class="ni">&amp;gt;</span>
<span class="ni">&amp;lt;</span>li<span class="ni">&amp;gt;</span>An<span class="w"> </span>interview<span class="w"> </span>with<span class="w"> </span>Yannick<span class="w"> </span>and<span class="w"> </span>Carlos<span class="w"> </span>from<span class="w"> </span>Nokia<span class="w"> </span>about<span class="w"> </span>the<span class="w"> </span>Nokia
Internet<span class="w"> </span>Tablet<span class="w"> </span>and<span class="w"> </span>the<span class="w"> </span>company<span class="ni">&amp;apos;</span>s<span class="w"> </span>approach<span class="w"> </span>to<span class="w"> </span>open-source<span class="w"> </span>software<span class="ni">&amp;lt;</span>/li<span class="ni">&amp;gt;</span>
<span class="ni">&amp;lt;</span>li<span class="ni">&amp;gt;</span>Bounties<span class="w"> </span>for<span class="w"> </span>writing<span class="w"> </span>code:<span class="w"> </span>are<span class="w"> </span>they<span class="w"> </span>a<span class="w"> </span>good<span class="w"> </span>idea?<span class="ni">&amp;lt;</span>/li<span class="ni">&amp;gt;</span>
<span class="ni">&amp;lt;</span>li<span class="ni">&amp;gt;</span>Ian<span class="w"> </span>Brown,<span class="w"> </span>head<span class="w"> </span>of<span class="w"> </span>FIPR,<span class="w"> </span>on<span class="w"> </span>ID<span class="w"> </span>cards<span class="w"> </span>in<span class="w"> </span>the<span class="w"> </span>UK,<span class="w"> </span>and<span class="w"> </span>whether<span class="w"> </span>they
should<span class="w"> </span>happen<span class="w"> </span>or<span class="w"> </span>not<span class="ni">&amp;lt;</span>/li<span class="ni">&amp;gt;</span>
<span class="ni">&amp;lt;</span>li<span class="ni">&amp;gt;</span>Samba:<span class="w"> </span>should<span class="w"> </span>we<span class="w"> </span>be<span class="w"> </span>inventing<span class="w"> </span>our<span class="w"> </span>own<span class="w"> </span>open<span class="w"> </span>protocols<span class="w"> </span>rather<span class="w"> </span>than
chasing<span class="w"> </span>the<span class="w"> </span>tail-lights<span class="w"> </span>of<span class="w"> </span>closed<span class="w"> </span>competitors?<span class="ni">&amp;lt;</span>/li<span class="ni">&amp;gt;</span>
<span class="ni">&amp;lt;</span>/ul<span class="ni">&amp;gt;</span>
<span class="nt">&lt;/description&gt;</span>
<span class="w">    </span><span class="nt">&lt;enclosure</span><span class="w"> </span><span class="na">url=</span><span class="s">&quot;http://lug.mtu.edu.nyud.net:8090/lugradio/lugradio-s02e19-040705-high.mp3?podcast&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;audio/mpeg&quot;</span><span class="w"> </span><span class="na">length=</span><span class="s">&quot;17659904&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="nt">&lt;/item&gt;</span>
</code></pre></div>

<p>The problem is this: if the enclosure <span class="caps"><span class="caps">URL</span></span>
changes, people’s podcast clients and <span class="caps"><span class="caps">RSS</span></span>
aggregators download stuff again. How can I avoid this&nbsp;happening?</p>
<p>A couple of suggested wrong&nbsp;solutions:</p>
<p>​1. <strong>Never change the <span class="caps"><span class="caps">URL</span></span></strong></p>
<p>Can’t do that. The <span class="caps"><span class="caps">URL</span></span> points to a mirrored
copy of the episode’s mp3 file. If that mirror goes offline (our mirrors
are run by volunteers without payment), we have to change the
<span class="caps"><span class="caps">URL</span></span> to point to&nbsp;another.</p>
<p>​2. <strong>Use a&nbsp;redirect</strong></p>
<p>Lots of people say “just make the <span class="caps"><span class="caps">URL</span></span> be
http://www.lugradio.org/mirrors/season2/episode19/mp3” and have that be
a <span class="caps"><span class="caps">CGI</span></span> script that redirects to a mirror. That
would be great <em>if</em> podcast clients were compliant
<span class="caps"><span class="caps">HTTP</span></span> clients, and followed redirects. In
practice, they are not and do not. This means that, if we implemented
the redirect <em>anyway</em>, we’d be secure in our integrity but lots of
people couldn’t download the show the way they want. Knowing that we are
right and they are wrong is cold comfort when we’re annoying our
listeners; we can’t use&nbsp;redirects.</p>
<p>​3. <strong>Coralize the podcast enclosure&nbsp;URLs</strong></p>
<p>Use the <a href="http://www.coralcdn.org/">Coral distribution network</a> to not put too much pressure on
the archive that goes into the mirror feed. We’re already doing this,
but if that archive goes away, the Coralized
<span class="caps"><span class="caps">URL</span></span> won’t point to anything, and we’ll have to
change the <span class="caps"><span class="caps">URL</span></span>. The Coral people are very
cool, but they won’t cache all our mp3 files&nbsp;indefinitely.</p>
<p>​4. <strong>Set up an archive that never goes&nbsp;away</strong></p>
<p>Essentially, this is a suggestion that goes with suggestion 1: make sure
that old mirror URLs don’t break by setting up the One Canonical Archive
that the podcast feed points at. The issue with doing that is that that
one archive gets hit pretty hard for bandwidth, because <em>all</em> the
podcast readers use it. This means that it has to be an archive with
lots of bandwidth to cover the initial download spike when an episode is
released. We could use archive.org, and we do upload episodes there, but
their upload process is long and laborious and would delay an episode’s
release by quite some time, which we’d rather not&nbsp;do.</p>
<p>​5. <strong>Do a ‘redirect’ by streaming the data through our
<span class="caps"><span class="caps">URL</span></span></strong></p>
<p>No-one’s suggested this, but I’ve thought of it. We could put the
<span class="caps"><span class="caps">URL</span></span> from the “redirect” suggestion above in
the feed, but instead of having that <span class="caps"><span class="caps">URL</span></span>
redirect to a mirror, that <span class="caps"><span class="caps">URL</span></span> points to a
<span class="caps"><span class="caps">CGI</span></span> script which downloads the data from a
mirror and streams it out on the fly to the consumer. I don’t want to do
this because it puts a horrific bandwidth requirement on the
lugradio.org machine; every downloaded byte of a LugRadio episode will
go through that machine, and we can’t afford the bandwidth for&nbsp;that.</p>
<p>At the moment, we Coralize URLs, and we’re trying to set up a Canonical
Archive based on a very useful donation (about which more in a few
days). But is there a better way? I can’t help but think that there
should be a better way around this; something with tag URIs or guids or
something. Remember that we need something which works with the podcast
clients that currently exist; I don’t want to hear “clients should
support <span class="caps"><span class="caps">XXXX</span></span> and if they don’t then you should
ignore them“, because we don’t have the luxury of doing that,&nbsp;sadly.</p>
<p>Any help will be greatly, greatly appreciated; I’ve been wrestling with
this problem for months now and I’m still not sure how to solve it.&nbsp;Thanks!</p>
		</div> <!--/#entry-content-->
		<ul class="neighbours-links">
		<li><a href="https://www.kryogenix.org/days/2005/07/09/birmingham/">Previous post</a></li>
		<li><a href="https://www.kryogenix.org/days/2005/07/15/ocelot/">Next post</a></li>
		</ul>

		<div class="hireme">
			I'm currently available for hire, to help you plan, architect, and build new systems, and for technical writing
			and articles. You can take a look at <a href="https://kryogenix.org">some projects I've worked on</a> and
			<a href="https://kryogenix.org/books">some of my writing</a>. If you'd like to talk about your upcoming project,
			do <a href="https://kryogenix.org/contact">get in touch.</a>
		</div>
	</div> <!--/#main-->
</div>  <!--/#post-->
<div id="webmentions">
<h4>More in the discussion (powered by <a href="http://indiewebcamp.com/Webmention">webmentions</a>)</h4>
	<ul><li>(no mentions, yet.)</li></ul>
<form id="wmform" method="POST" action="https://webmention.herokuapp.com/api/webmention">
	<label>Did you link to this post? Enter your page's URL:
	<input type="url" name="source"></label>
	<input type="hidden" name="target" value="https://www.kryogenix.org/days/2005/07/10/enclosure/">
	<input type="submit" value="Add link">
</form>
<script src="https://www.kryogenix.org/days/theme/live-webmentions-cors.js"></script>
</div>

<p id="oldcomments"></p>
<script>
var aurl = '2005/07/10/enclosure/';
var parts = aurl.split('/');
if (parts[parts.length-1] === "") { parts = parts.slice(0, parts.length-1); }
var tooNewForOldComments = false;
if (parts[0].match(/^[0-9]+$/)) {
	var asnum = parseInt(parts[0], 10);
	if (!isNaN(asnum) && asnum > 2014) {
		tooNewForOldComments = true;
	}
}
if (!tooNewForOldComments) {
	var comurl = "/oldcomments/" + parts.join("-") + ".html";
	var x = new XMLHttpRequest();
	x.open("HEAD", comurl, true);
	x.onreadystatechange = function() {
		if (x.readyState == 4) {
			if (x.status == 200) {
				document.getElementById("oldcomments").innerHTML = '<a href="' + comurl + '">See pre-2014 comments on this post</a>';
			}
		}
	};
	x.send();
}
</script>
<script type="module">
/* jslint esversion: 11 */
try {
	const resp = await fetch("/adpb-popular.json");
	const vals = await resp.json();
	let popular = vals[location.pathname];
	if (!popular && location.pathname.endsWith("/")) {
		popular = vals[location.pathname.replace(/\/$/, "")];
	}
	if (popular && popular.recent_idx != null) {
		let a = document.createElement("a");
		let p = document.createElement("p");
		p.className = "trending";
		a.href = "/adpb-popular.html";
		a.append(`#${popular.recent_idx + 1} in Trending`);
		p.append(a);
		const ec = document.querySelector("div.entry-content");
		ec.insertBefore(p, ec.firstChild);
	}
} catch(e) {
	console.error("Failed to fetch popular list", e);
}
</script>

		</div>
		
		<div id="footer">
			<p>Powered by <a href="http://pelican.readthedocs.org">Pelican</a>, theme by <a href="http://bunnyman.info">tBunnyMan</a>.</p>
			<script src="https://the-claw-webring-widget.netlify.app/the-claw-webring-widget.mjs" type="module"></script>
			<the-claw-webring-widget />
			<!-- Global site tag (gtag.js) - Google Analytics. Cookie set to be a session cookie, not permanent, for privacy
			https://developers.google.com/analytics/devguides/collection/gtagjs/cookies-user-id#cookie_expiration -->
			<script async src="https://www.googletagmanager.com/gtag/js?id=UA-331575-1"></script>
			<script>
  				window.dataLayer = window.dataLayer || [];
  				function gtag(){dataLayer.push(arguments);}
  				gtag('js', new Date());
  				gtag('config', 'UA-331575-1', {cookie_expires: 0});
			</script>
		</div><!-- /#footer -->
	</div><!-- /#container -->




<div id="loadtimer"></div>
<script>
window.onload = function(){
    setTimeout(function(){
      window.performance = window.performance || 
window.mozPerformance || window.msPerformance || 
window.webkitPerformance || {};
      var t = performance.timing || {};
      if (!t) {
        
        return;
      }
      var start = t.navigationStart,
          end = t.loadEventEnd
          loadTime = (end - start) / 1000;
      var copy = document.getElementById('loadtimer');
      copy.innerHTML += "This page loaded in " + loadTime + " seconds.";
    }, 0); 
}

</script>
</body> </html>