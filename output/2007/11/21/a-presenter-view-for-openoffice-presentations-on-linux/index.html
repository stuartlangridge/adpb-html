<!DOCTYPE html>
<html lang="en">
<head>
		<title>as days pass by &mdash; A "presenter view" for OpenOffice presentations on Linux</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<link rel="profile" href="http://gmpg.org/xfn/11" />
		<meta name="Description" content="Stuart Langridge of Kryogenix Consulting, for consultancy and custom development on the web and devices">
        <meta property="og:title" content="as days pass by &mdash; A "presenter view" for OpenOffice presentations on Linux">
        <meta property="og:type" content="website">
        <meta property="og:site_name" content="as days pass by">
        <meta property="og:description" content="A post by Stuart Langridge (sil)">
        <meta property="og:image" content="https://www.kryogenix.org/days/2007/11/21/a-presenter-view-for-openoffice-presentations-on-linux/index.html.og_image.png">
        <meta name="twitter:card" content="summary_large_image">
        <meta name="twitter:site" content="@sil">
        <meta name="twitter:image" content="https://www.kryogenix.org/days/2007/11/21/a-presenter-view-for-openoffice-presentations-on-linux/index.html.og_image.png">
		<link rel="stylesheet" type="text/css" href="../../../../theme/css/adpb.css" />
		<link rel="stylesheet" type="text/css" href="../../../../theme/css/simple-footnotes.css" />
		<link rel="icon" type="image/png" href="/favicon.png" />
		<link rel="alternate" type="application/rss+xml"
			title="as days pass by"
			href="https://www.kryogenix.org/days/feed" /> 
		<meta property="fediverse:creator" content="@sil@mastodon.social" />
		<link rel="webmention" href="https://webmention.herokuapp.com/api/webmention" />
		<link rel="feed" href="https://www.kryogenix.org/days/archives/"> 
</head>

<body class="home blog custom-background single-author" >
		<header>
				<p>A blog by <a href="https://www.kryogenix.org/">Stuart Langridge</a></p>
				<h1 id="site-title"><a href="https://www.kryogenix.org/days">as days pass by</a></h1>
<h2 id="site-description">scratched tallies on the prison wall</h2>		</header><!-- /#banner -->
		
		<nav>
			<ul>
				<li><a href="/">Kryogenix Consulting</a></li>
				<li><a href="/days/archives">All posts, ever</a></li>
				<li><a href="/code">Code</a></li>
			</ul>
		</nav>
		
		<div class="page-title">
		</div>
	
		<div id="contents">

<div class="post type-post status-publish format-standard hentry category-general h-entry" id="post">
	<div class="entry-meta">
		<div class="date"><a href="https://www.kryogenix.org/days/2007/11/21/a-presenter-view-for-openoffice-presentations-on-linux/"><time 
			class="dt-published" datetime="2007-11-21T23:41:00+00:00">Nov 21 2007</time></a>
		</div>
	</div> <!-- /#entry-meta -->
	<div class="main">
		<h2 class="entry-title">
			<a class="u-url p-name" href="https://www.kryogenix.org/days/2007/11/21/a-presenter-view-for-openoffice-presentations-on-linux/">A "presenter view" for OpenOffice presentations on Linux</a>
		</h2>
		<div class="entry-content e-content">
			<p>Earlier this week I was at <a href="http://www.vivabit.com/atmediaAjax/">@media Ajax</a>, and it was great -- more in
an upcoming post. First, though, a quick bit of scripting I did. You
see, it's become apparent to me that I need a "presenter view" when I'm
presenting; I have my laptop running dualscreen, so that the view I get
on the laptop screen is not the view that appears on the projector. I
need this, because I'm not Derek Featherstone; I can't just see the
slides and remember everything that I need to say. My slides are often
just a single word, or a picture, and I can't remember the thread of
what I'm aiming at without
notes.<span style="color: red" title="Derek's are too, but he can remember his whole presentation and I can't, because he's better at this than me">*</span>
So, I used to have notes on a bit of paper. The way I create
presentations is:</p>
<ol>
<li>Write out, longhand, everything I intend to say, word-for-word, like
    it's an essay or a playscript</li>
<li>Go through my longhand script and identify all the slides I want to
    put in to bolster the points</li>
<li>Spend some time with <a href="http://flickr.com/creativecommons">Flickr's Creative Commons image search</a>
    finding the images that I want for slides</li>
<li>Put together a presentation</li>
<li>Make notes for each slide expressing the bullet points of what I
    want to say, with notes to myself to remind me of any particular
    phrases I want to specifically remember</li>
<li>Throw away the longhand script</li>
</ol>
<p>The final step, after that lot, used to be "write out all of the notes
in big writing on bits of A4 paper". Then it occurred to me: why not use
the presenter view to put my notes on? I used <a href="http://meyerweb.com/eric/tools/s5/">S5</a>, Eric Meyer's
in-browser HTML/CSS/JavaScript based presentation system, for a long
time to make my talks, and it has a presenter view. However, I got
increasingly hacked off with it being slow and annoying, and so I
resolved to use OpenOffice for presentations; it's just easier.
OpenOffice, though, doesn't have a presenter view (<a href="http://wiki.services.openoffice.org/wiki/Impress_presenter_mode_specification">there's a spec for
it</a>, but it doesn't yet exist). After a bit of casting about, I
discovered that (a) OpenOffice will export presentations to PDF, and (b)
Evince, the Gnome document viewer, has a presentation mode. So, thought
I, I could use that instead. OpenOffice allows you to export the notes
pages too into your PDF: if you've got three slides in your
presentation<span style="color: red" title="I refuse to call it a 'slide deck'">*</span>,
each with notes, and you elect to include notes pages in the PDF export,
then you get <em>six</em> pages in the resultant PDF — the first three are just
the slides, and the second three are the slides at the top of the page
with the notes below. So the idea appeared in my head: why not open the
PDF <em>twice</em>, put PDF-1 on page 1 and display it on the projector, and
PDF-2 on page 4 (the first notes page) and display it on my screen? Then
just get them to advance in lockstep — when I advance the projector PDF
by one page, it advances the notes view on my laptop screen by one page
as well — and lo, I have a presenter view. Those of you with (a) modern
versions of PowerPoint or (b) whatever the Mac presentation thing is
called are doubtless laughing your heads off right now, and rightfully
so. I can't wait for the OpenOffice people to make this happen properly.
Anyway, to do the advancing, you need a little script. This little
script uses <a href="http://web.archive.org/web/20071121234100/http://people.redhat.com/zcerza/dogtail/">dogtail</a> to provide the presenter view, and I used it on
Monday and it worked perfectly. Be warned: this is not a proper
solution. It's a crappy hack, and if it de-bones your cat and deletes
everything on your hard drive, don't come crying to me. Almost certainly
requires Linux, requires dogtail (and accessibility mode turned on in
Gnome (NFI whether KDE has the same features, but it probably does; if
you use something other than Gnome or KDE then you're on your own, you
freak)), requires Python and PyGtk, requires Evince (which should be
called "Document Viewer"), requires a PDF (that has been exported from
OpenOffice.org Impress with notes page included) on the command line,
requires a laptop that can do dualhead (mine seems to set up the two
screens as One Big Screen, so I don't know what happens if you have
something that actually does it properly), probably requires the phase
of the moon to be right as well. Enjoy.  </p>
<h3><a href="http://www.kryogenix.org/code/evince-presenter-view.py">Evince presenter view</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">gtk</span><span class="o">,</span><span class="w"> </span><span class="nn">sys</span><span class="o">,</span><span class="w"> </span><span class="nn">random</span><span class="o">,</span><span class="w"> </span><span class="nn">shutil</span><span class="o">,</span><span class="w"> </span><span class="nn">os</span><span class="o">,</span><span class="w"> </span><span class="nn">time</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">dogtail.tree</span><span class="w"> </span><span class="kn">import</span><span class="w"> </span><span class="n">root</span>

<span class="n">pdf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="c1"># copy pdf to /tmp</span>
<span class="n">pdfcopyname</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;pdf.</span><span class="si">%s</span><span class="s2">.pdf&quot;</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span>
<span class="n">pdfcopy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;/tmp/&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">pdfcopyname</span>
<span class="n">shutil</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">pdf</span><span class="p">,</span><span class="w"> </span><span class="n">pdfcopy</span><span class="p">)</span>

<span class="c1"># start two evinces</span>
<span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s2">&quot;evince --presentation --page-label=1 </span><span class="si">%s</span><span class="s2"> &amp;&quot;</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="n">pdf</span><span class="p">)</span>
<span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s2">&quot;evince </span><span class="si">%s</span><span class="s2"> &amp;&quot;</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="n">pdfcopy</span><span class="p">)</span>

<span class="c1"># find them with dogtail</span>
<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">dogtail.tree</span><span class="w"> </span><span class="kn">import</span><span class="w"> </span><span class="n">root</span>
<span class="n">evince</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">root</span><span class="o">.</span><span class="n">application</span><span class="p">(</span><span class="s2">&quot;evince&quot;</span><span class="p">)</span>
<span class="n">pdfw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">evince</span><span class="o">.</span><span class="n">window</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">pdf</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">pdfcopyw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">evince</span><span class="o">.</span><span class="n">window</span><span class="p">(</span><span class="n">pdfcopyname</span><span class="p">)</span>
<span class="n">halfpages</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">int</span><span class="p">(</span><span class="n">pdfw</span><span class="o">.</span><span class="n">child</span><span class="p">(</span><span class="n">roleName</span><span class="o">=</span><span class="s2">&quot;tool bar&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">child</span><span class="p">(</span><span class="n">roleName</span><span class="o">=</span><span class="s2">&quot;label&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">1</span><span class="p">])</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">2</span>
<span class="n">pdfpageel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pdfw</span><span class="o">.</span><span class="n">child</span><span class="p">(</span><span class="n">roleName</span><span class="o">=</span><span class="s2">&quot;tool bar&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">child</span><span class="p">(</span><span class="n">roleName</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">)</span>
<span class="n">pdfcopypageel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pdfcopyw</span><span class="o">.</span><span class="n">child</span><span class="p">(</span><span class="n">roleName</span><span class="o">=</span><span class="s2">&quot;tool bar&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">child</span><span class="p">(</span><span class="n">roleName</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">ping</span><span class="p">():</span>
<span class="w">  </span><span class="k">global</span><span class="w"> </span><span class="n">pdfw</span><span class="p">,</span><span class="w"> </span><span class="n">pdfcopyw</span><span class="p">,</span><span class="w"> </span><span class="n">halfpages</span><span class="p">,</span><span class="w"> </span><span class="n">pdfpageel</span><span class="p">,</span><span class="w"> </span><span class="n">pdfcopypageel</span>
<span class="w">  </span><span class="k">try</span><span class="p">:</span>
<span class="w">    </span><span class="n">pdfpage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">int</span><span class="p">(</span><span class="n">pdfpageel</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
<span class="w">    </span><span class="n">pdfcopypage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">int</span><span class="p">(</span><span class="n">pdfcopypageel</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
<span class="w">  </span><span class="k">except</span><span class="w"> </span><span class="n">ValueError</span><span class="p">:</span>
<span class="w">    </span><span class="c1"># pdf window has been destroyed, probably</span>
<span class="w">    </span><span class="k">raise</span><span class="w"> </span><span class="s2">&quot;die&quot;</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">pdfpage</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">halfpages</span><span class="p">)</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">pdfcopypage</span><span class="p">:</span>
<span class="w">    </span><span class="n">pdfcopypage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pdfpage</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">halfpages</span>
<span class="w">    </span><span class="n">pdfcopypageel</span><span class="o">.</span><span class="n">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">str</span><span class="p">(</span><span class="n">pdfcopypage</span><span class="p">)</span>
<span class="w">    </span><span class="n">pdfcopypageel</span><span class="o">.</span><span class="n">doAction</span><span class="p">(</span><span class="s2">&quot;activate&quot;</span><span class="p">)</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="kc">True</span>


<span class="n">pingobj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gtk</span><span class="o">.</span><span class="n">timeout_add</span><span class="p">(</span><span class="mi">500</span><span class="p">,</span><span class="w"> </span><span class="n">ping</span><span class="p">)</span>
<span class="k">try</span><span class="p">:</span>
<span class="w">  </span><span class="n">gtk</span><span class="o">.</span><span class="n">main</span><span class="p">()</span>
<span class="k">except</span><span class="p">:</span>
<span class="w">  </span><span class="n">os</span><span class="o">.</span><span class="n">unlink</span><span class="p">(</span><span class="n">pdfcopy</span><span class="p">)</span>
</code></pre></div>
		</div> <!--/#entry-content-->
		<ul class="neighbours-links">
		<li><a href="https://www.kryogenix.org/days/2007/11/11/cruciforum-v124/">Previous post</a></li>
		<li><a href="https://www.kryogenix.org/days/2007/11/22/media-ajax-2007/">Next post</a></li>
		</ul>

		<div class="hireme">
			I'm currently available for hire, to help you plan, architect, and build new systems, and for technical writing
			and articles. You can take a look at <a href="https://kryogenix.org">some projects I've worked on</a> and
			<a href="https://kryogenix.org/books">some of my writing</a>. If you'd like to talk about your upcoming project,
			do <a href="https://kryogenix.org/contact">get in touch.</a>
		</div>
	</div> <!--/#main-->
</div>  <!--/#post-->
<div id="webmentions">
<h4>More in the discussion (powered by <a href="http://indiewebcamp.com/Webmention">webmentions</a>)</h4>
	<ul><li>(no mentions, yet.)</li></ul>
<form id="wmform" method="POST" action="https://webmention.herokuapp.com/api/webmention">
	<label>Did you link to this post? Enter your page's URL:
	<input type="url" name="source"></label>
	<input type="hidden" name="target" value="https://www.kryogenix.org/days/2007/11/21/a-presenter-view-for-openoffice-presentations-on-linux/">
	<input type="submit" value="Add link">
</form>
<script src="https://www.kryogenix.org/days/theme/live-webmentions-cors.js"></script>
</div>

<p id="oldcomments"></p>
<script>
var aurl = '2007/11/21/a-presenter-view-for-openoffice-presentations-on-linux/';
var parts = aurl.split('/');
if (parts[parts.length-1] === "") { parts = parts.slice(0, parts.length-1); }
var tooNewForOldComments = false;
if (parts[0].match(/^[0-9]+$/)) {
	var asnum = parseInt(parts[0], 10);
	if (!isNaN(asnum) && asnum > 2014) {
		tooNewForOldComments = true;
	}
}
if (!tooNewForOldComments) {
	var comurl = "/oldcomments/" + parts.join("-") + ".html";
	var x = new XMLHttpRequest();
	x.open("HEAD", comurl, true);
	x.onreadystatechange = function() {
		if (x.readyState == 4) {
			if (x.status == 200) {
				document.getElementById("oldcomments").innerHTML = '<a href="' + comurl + '">See pre-2014 comments on this post</a>';
			}
		}
	};
	x.send();
}
</script>
<script type="module">
/* jslint esversion: 11 */
try {
	const resp = await fetch("/adpb-popular.json");
	const vals = await resp.json();
	let popular = vals[location.pathname];
	if (!popular && location.pathname.endsWith("/")) {
		popular = vals[location.pathname.replace(/\/$/, "")];
	}
	if (popular && popular.recent_idx != null) {
		let a = document.createElement("a");
		let p = document.createElement("p");
		p.className = "trending";
		a.href = "/adpb-popular.html";
		a.append(`#${popular.recent_idx + 1} in Trending`);
		p.append(a);
		const ec = document.querySelector("div.entry-content");
		ec.insertBefore(p, ec.firstChild);
	}
} catch(e) {
	console.error("Failed to fetch popular list", e);
}
</script>
<!-- <script src="https://www.kryogenix.org/days/theme/unrot-redirect.js"></script> -->
		</div>
		
		<footer>
			<p>Powered by <a href="http://pelican.readthedocs.org">Pelican</a></p>
		</footer>




<div id="loadtimer"></div>
<script>
window.onload = function(){
    setTimeout(function(){
      window.performance = window.performance || 
window.mozPerformance || window.msPerformance || 
window.webkitPerformance || {};
      var t = performance.timing || {};
      if (!t) {
        
        return;
      }
      var start = t.navigationStart,
          end = t.loadEventEnd
          loadTime = (end - start) / 1000;
      var copy = document.getElementById('loadtimer');
      copy.innerHTML += "This page loaded in " + loadTime + " seconds.";
    }, 0); 
}

</script>
</body> </html>