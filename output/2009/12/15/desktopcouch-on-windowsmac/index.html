<!DOCTYPE html>
<html lang="en">
<head>
		<title>as days pass by &mdash; Desktopcouch on Windows/Mac</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<link rel="profile" href="http://gmpg.org/xfn/11" />
		<link href="https://fonts.googleapis.com/css?display=swap&family=Averia+Serif+Libre|Enriqueta:400,700" rel="stylesheet">
		<meta name="monetization" content="$pay.stronghold.co/1a198b49b9914f84e218d360b725bca1fd1">
		<meta name="Description" content="Stuart Langridge of Kryogenix Consulting, for consultancy and custom development on the web and devices">
		<link rel="stylesheet" type="text/css" href="https://www.kryogenix.org/days/theme/css/style.css" />
		<link rel="stylesheet" type="text/css" href="https://www.kryogenix.org/days/theme/css/simple-footnotes.css" />
		<link rel="icon" type="image/png" href="/favicon.png" />
		<style type="text/css">
			body.custom-background {
				background: url(https://www.kryogenix.org/days/theme/handmadepaper.png); /* thank you subtlepatterns! */
			}
		</style>
		<link rel="alternate" type="application/rss+xml"
			title="as days pass by"
			href="https://www.kryogenix.org/days/feed" /> 
		<!--[if lte IE 8]><script src="https://www.kryogenix.org/days/theme/js/html5shiv.js"></script><![endif]-->
		<link rel="webmention" href="https://webmention.herokuapp.com/api/webmention" />
		<link rel="feed" href="https://www.kryogenix.org/days/archives/"> 
		<script src="https://cdn.ravenjs.com/3.4.1/raven.min.js"></script>
		<script>Raven.config('https://fc8cd4c9637043f3b385d9daa8dbe367@app.getsentry.com/91852').install()</script>
</head>

<body class="home blog custom-background single-author" >
	<div id="container">
		<div id="header">
				<p>A blog by <a href="https://www.kryogenix.org/">Stuart Langridge</a></p>
				<h1 id="site-title"><a href="https://www.kryogenix.org/days">as days pass by</a></h1>
<h2 id="site-description">scratched tallies on the prison wall</h2>		</div><!-- /#banner -->
		
		<div id="menu">
			<div class="menu-navigation-container">
				<ul id="menu-navigation" class="menu">
						<li  class="active" class="menu-item menu-item-type-post_type menu-item-object-page"><a href="/">Kryogenix Consulting</a></li>
						<li  class="active" class="menu-item menu-item-type-post_type menu-item-object-page"><a href="/days/archives">All posts, ever</a></li>
						<li  class="active" class="menu-item menu-item-type-post_type menu-item-object-page"><a href="/code">Code</a></li>

				</ul>
			</div> <!--/#menu-navigation-container-->
		</div><!-- /#menu -->
		
		<div class="page-title">
		</div>
	
		<div id="contents">

<div class="post type-post status-publish format-standard hentry category-general h-entry" id="post">
	<div class="entry-meta">
		<div class="date"><a href="https://www.kryogenix.org/days/2009/12/15/desktopcouch-on-windowsmac/"><time 
			class="dt-published" datetime="2009-12-15T13:39:00+00:00">Dec 15 2009</time></a>
			<span class="byline h-card">By <a class="p-author" href="https://www.kryogenix.org/days/"><img src="https://kryogenix.org/images/hackergotchi-simpler.png" class="u-photo" alt=""> <span class="p-name">sil</span></a></span>
		</div>
	</div> <!-- /#entry-meta -->
	<div class="main">
		<h2 class="entry-title">
			<a class="u-url p-name" href="https://www.kryogenix.org/days/2009/12/15/desktopcouch-on-windowsmac/" title="Permalink to Desktopcouch on Windows/Mac" rel="bookmark">Desktopcouch on&nbsp;Windows/Mac</a>
		</h2>
		<div class="entry-content e-content">
			<p>One of the things that I&#8217;d really like to see is <a href="http://www.freedesktop.org/wiki/Specifications/desktopcouch">desktopcouch</a> on
Windows and the Mac, so that your data can be everywhere, on all your
machines. Now, I don&#8217;t know enough about those platforms to actually do
it, but I&#8217;d be happy to help anyone who was interested in making it
happen; here are some thoughts on what&#8217;d be required, and do please chip
in here with questions, or ask me or others on the <code>#ubuntuone</code> <span class="caps">IRC</span>
channel on <code>irc.freenode.net</code>. Desktop Couch, for those of you who
aren&#8217;t sure, is a personal CouchDB that your apps can store their data
in. It&#8217;s secured for you alone, and it comes with a built-in replication
setup, so two desktopcouches on the same network can exchange data. This
means that if your applications store their data in desktopcouch — for
example, Bindwood, our Firefox extension to store your bookmarks there —
then all the machines on your network can exchange that data, meaning
that adding a bookmark on one of your machines will automatically add it
on the others, without you having to do anything, and without you having
to sign up to some third-party service to make that happen. It&#8217;ll all
work on your local network. (It can also work via a third-party service
— Ubuntu One is such a service, and there could be others, as long as
they deploy CouchDB in the cloud — so that machines on different
networks can also exchange&nbsp;data.)  </p>
<h3>CouchDB</h3>
<p>The first thing you need to have, to get a personal CouchDB, is CouchDB.
I know the <a href="https://mozillalabs.com/raindrop">Mozilla Raindrop</a> team have done some work getting CouchDB
nice and robust and working on Windows, and I believe they have an
installer. Working with that would be very cool indeed. (Indeed, it&#8217;s
possible for <a href="http://www.kryogenix.org/days/2009/10/23/running-raindrop-on-ubuntu-9-10-using-desktop-couch">Raindrop to use desktopcouch</a> if you have it, so that
might be an interesting&nbsp;test!)  </p>
<h3>On-demand startup and port numbers (or, what&#8217;s your&nbsp;D-Bus?)</h3>
<p>Desktopcouch is started on demand, when the first application requires
it, rather than running all the time even when you don&#8217;t need it.
Because it is a <em>personal</em> CouchDB, and because there might be more than
one user on the machine that you&#8217;re on, it can&#8217;t run on a specific port
number; instead, you ask desktopcouch for its port number when you want
it, and asking that question starts it up on a randomly-chosen port if
it&#8217;s not already running. The way this is done on Ubuntu (and other
Linuxes) is with D-Bus, which is a Linux-specific <span class="caps">IPC</span> mechanism. It&#8217;s
possible to use D-Bus on other platforms, but a much better way would be
to use your platform&#8217;s specific way of passing messages to a service and
starting a service if it&#8217;s not already running. (This is one of the
things I don&#8217;t know how to do on other platforms. Would Macs use launchd
or something? Should a Windows service be running on startup? I don&#8217;t
know.) Desktopcouch only uses D-Bus for these two things (&#8220;what&#8217;s your
port number&#8221; and &#8220;start this service if it&#8217;s not already running&#8221;), so
replacing those sections with a native way of doing that on Windows/Mac
would be reasonably easy and make it fit in much better with the Right
Way of doing things on that platform; these changes would need to be
made both in desktopcouch itself, and in APIs (desktopcouch.records)
that connect to&nbsp;desktopcouch.  </p>
<h3>Where are the keys? (or, no gnome-keyring on&nbsp;Windows)</h3>
<p>Because desktopcouch is a personal CouchDB, access to it is secured by
OAuth. When desktopcouch is first set up, it randomly generates a set of
OAuth tokens, and these are stored in the Gnome keyring on Ubuntu.
Obviously, it would be better to use the platform&#8217;s own way of storing
authentication data; I believe the Mac has a &#8220;keychain&#8221;, and Windows
surely has something similar. Again, this would need changing in
desktopcouch itself (to store the keys in the right place), and in
desktopcouch.records (to retrieve the keys from that place to use&nbsp;them).  </p>
<h3>And that&#8217;s&nbsp;it</h3>
<p>With those changes in place, desktopcouch should run on another
platform, meaning that you can exchange data between all your apps on
all your machines. We&#8217;re already getting some sterling work done to see
desktopcouch on other Linux distributions and on phones like the Nokia
N900 (hooray for <a href="http://thomas.apestaart.org/log/?p=1086">Thomas</a>, among others!). I&#8217;d really like to see this
happen on Windows and Mac too; are you interested in helping make it
happen? Let me know, and I&#8217;ll give you all the help you&nbsp;need!</p>
		</div> <!--/#entry-content-->
		<ul class="neighbours-links">
		<li><a href="https://www.kryogenix.org/days/2009/12/09/multiple-format-wordpress-podcast-feeds/">Previous post</a></li>
		<li><a href="https://www.kryogenix.org/days/2009/12/23/migrating-this-weblog-to-couchdb/">Next post</a></li>
		</ul>

		<div class="hireme">
			I'm currently available for hire, to help you plan, architect, and build new systems, and for technical writing
			and articles. You can take a look at <a href="https://kryogenix.org">some projects I've worked on</a> and
			<a href="https://kryogenix.org/books">some of my writing</a>. If you'd like to talk about your upcoming project,
			do <a href="https://kryogenix.org/contact">get in touch.</a>
		</div>
	</div> <!--/#main-->
</div>  <!--/#post-->
<div id="similar_posts">
	<strong>Similar posts: </strong>
	<a href="https://www.kryogenix.org/days/2009/09/03/desktop-couch-irc-talk/">Desktop Couch IRC talk</a>,	<a href="https://www.kryogenix.org/days/2010/01/26/adding-ubuntu-one-support-to-your-applications-an-irc-lecture/">Adding Ubuntu One support to your applications, an IRC lecture</a></div>
<div id="webmentions">
<h4>More in the discussion (powered by <a href="http://indiewebcamp.com/Webmention">webmentions</a>)</h4>
	<ul><li>(no mentions, yet.)</li></ul>
<form id="wmform" method="POST" action="https://webmention.herokuapp.com/api/webmention">
	<label>Did you link to this post? Enter your page's URL:
	<input type="url" name="source"></label>
	<input type="hidden" name="target" value="https://www.kryogenix.org/days/2009/12/15/desktopcouch-on-windowsmac/">
	<input type="submit" value="Add link">
</form>
<script src="https://www.kryogenix.org/days/theme/live-webmentions-cors.js"></script>
</div>

<p id="oldcomments"></p>
<script>
var aurl = '2009/12/15/desktopcouch-on-windowsmac/';
var parts = aurl.split('/');
if (parts[parts.length-1] === "") { parts = parts.slice(0, parts.length-1); }
var tooNewForOldComments = false;
if (parts[0].match(/^[0-9]+$/)) {
	var asnum = parseInt(parts[0], 10);
	if (!isNaN(asnum) && asnum > 2014) {
		tooNewForOldComments = true;
	}
}
if (!tooNewForOldComments) {
	var comurl = "/oldcomments/" + parts.join("-") + ".html";
	var x = new XMLHttpRequest();
	x.open("HEAD", comurl, true);
	x.onreadystatechange = function() {
		if (x.readyState == 4) {
			if (x.status == 200) {
				document.getElementById("oldcomments").innerHTML = '<a href="' + comurl + '">See pre-2014 comments on this post</a>';
			}
		}
	};
	x.send();
}
</script>
<script type="module">
/* jslint esversion: 11 */
try {
	const resp = await fetch("/adpb-popular.json");
	const vals = await resp.json();
	let popular = vals[location.pathname];
	if (!popular && location.pathname.endsWith("/")) {
		popular = vals[location.pathname.replace(/\/$/, "")];
	}
	if (popular && popular.recent_idx != null) {
		let a = document.createElement("a");
		let p = document.createElement("p");
		p.className = "trending";
		a.href = "/adpb-popular.html";
		a.append(`#${popular.recent_idx + 1} in Trending`);
		p.append(a);
		const ec = document.querySelector("div.entry-content");
		ec.insertBefore(p, ec.firstChild);
	}
} catch(e) {
	console.error("Failed to fetch popular list", e);
}
</script>

		</div>
		
		<div id="footer">
			<p>Powered by <a href="http://pelican.readthedocs.org">Pelican</a>, theme by <a href="http://bunnyman.info">tBunnyMan</a>.</p>
			<!-- Global site tag (gtag.js) - Google Analytics. Cookie set to be a session cookie, not permanent, for privacy
			https://developers.google.com/analytics/devguides/collection/gtagjs/cookies-user-id#cookie_expiration -->
			<script async src="https://www.googletagmanager.com/gtag/js?id=UA-331575-1"></script>
			<script>
  				window.dataLayer = window.dataLayer || [];
  				function gtag(){dataLayer.push(arguments);}
  				gtag('js', new Date());
  				gtag('config', 'UA-331575-1', {cookie_expires: 0});
			</script>
		</div><!-- /#footer -->
	</div><!-- /#container -->




<div id="loadtimer"></div>
<script>
window.onload = function(){
    setTimeout(function(){
      window.performance = window.performance || 
window.mozPerformance || window.msPerformance || 
window.webkitPerformance || {};
      var t = performance.timing || {};
      if (!t) {
        
        return;
      }
      var start = t.navigationStart,
          end = t.loadEventEnd
          loadTime = (end - start) / 1000;
      var copy = document.getElementById('loadtimer');
      copy.innerHTML += "This page loaded in " + loadTime + " seconds.";
    }, 0); 
}

</script>
</body> </html>