<!DOCTYPE html>
<html lang="en">
<head>
		<title>as days pass by &mdash; More thoughts on Linglish</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
		<link rel="profile" href="http://gmpg.org/xfn/11" />
		<link rel="stylesheet" type="text/css" href="http://www.kryogenix.org/days/theme/css/style.css" />
		<link rel='stylesheet' id='oswald-css'  href='http://fonts.googleapis.com/css?family=Oswald&#038;ver=3.3.2' type='text/css' media='all' />
		<link rel="stylesheet" type="text/css" href="http://www.kryogenix.org/days/theme/css/simple-footnotes.css" />
		<link rel="icon" type="image/png" href="/favicon.png" />
		<style type="text/css">
			body.custom-background { background-color: #f5f5f5; }
		</style>
		<link rel="alternate" type="application/rss+xml"
			title="as days pass by"
			href="http://www.kryogenix.org/days/feed" /> 
		<!--[if lte IE 8]><script src="http://www.kryogenix.org/days/theme/js/html5shiv.js"></script><![endif]-->
		<link rel="webmention" href="https://webmention.herokuapp.com/api/webmention" />
		<link rel="feed" href="http://www.kryogenix.org/days/archives/"> 
</head>

<body class="home blog custom-background single-author" >
	<div id="container">
		<div id="header">
				<p>A blog by <a href="http://www.kryogenix.org/">Stuart Langridge</a></p>
				<h1 id="site-title"><a href="http://www.kryogenix.org/days">as days pass by</a></h1>
<h2 id="site-description">scratched tallies on the prison wall</h2>		</div><!-- /#banner -->
		
		<div id="menu">
			<div class="menu-navigation-container">
				<ul id="menu-navigation" class="menu">
						<li  class="active" class="menu-item menu-item-type-post_type menu-item-object-page"><a href="/">Kryogenix Consulting</a></li>
						<li  class="active" class="menu-item menu-item-type-post_type menu-item-object-page"><a href="/days/archives">All posts, ever</a></li>
						<li  class="active" class="menu-item menu-item-type-post_type menu-item-object-page"><a href="/code">Code</a></li>

				</ul>
			</div> <!--/#menu-navigation-container-->
		</div><!-- /#menu -->
		
		<div class="page-title">
		</div>
	
		<div id="contents">

<div class="post type-post status-publish format-standard hentry category-general h-entry" id="post">
	<div class="entry-meta">
		<div class="date"><a href="http://www.kryogenix.org/days/2009/02/11/more-thoughts-on-linglish/"><time 
			class="dt-published" datetime="2009-02-11T22:35:00">Feb 11 2009</time></a>
			<span class="byline h-card">By <a class="p-author" href="http://www.kryogenix.org/days/"><img src="http://kryogenix.org/images/hackergotchi-simpler.png" class="u-photo" alt=""> <span class="p-name">sil</span></a></span>
		</div>
	</div> <!-- /#entry-meta -->
	<div class="main">
		<h2 class="entry-title">
			<a class="u-url p-name" href="http://www.kryogenix.org/days/2009/02/11/more-thoughts-on-linglish/" title="Permalink to More thoughts on Linglish" rel="bookmark">More thoughts on&nbsp;Linglish</a>
		</h2>
		<div class="entry-content e-content">
			<p>I still don&#8217;t have a decent name for &#8220;Linglish&#8221;, the toy <a href="http://www.kryogenix.org/days/2009/02/08/linglish-or-some-thoughts-on-a-scripting-language-for-the-linux-desktop">scripting language for the Linux desktop that I was playing around with a couple of days ago</a>. I&#8217;ve added a couple more features to satisfy my
curiosity about how hard it would be to do, and I&#8217;ve read the comments
on the previous post with a great deal of interest. Thanks to everyone
who chimed in with&nbsp;thoughts.</p>
<h2>First, what Linglish can now&nbsp;do:</h2>
<p><strong>tell</strong> <span style="color: green;">screensaver</span> <strong>to</strong>
<span style="color: green;">lock</span></p>
<p>A simple command: just tell one
application to do one&nbsp;thing.</p>
<p>
**ask** <span style="color: green;">banshee</span>&#8216;s
<span style="color: green;">engine</span> **for**
<span style="color: green;">uri</span>

Request the value of something
from an application. If you do this from the command-line, the value is
printed out:

    $ python linglish/runner.py -c &#8220;ask banshee&#8217;s engine for uri&#8221;
    file:///home/aquarius/Music/New%20Order%20-%20World%20in%20Motion).<span class="caps">MP3</span>

**tell** <span style="color: green;">banshee</span>&#8216;s
<span style="color: green;">engine</span> **to**
<span style="color: green;">pause</span>  

**tell** <span style="color: green;">screensaver</span> **to**
<span style="color: green;">lock</span>  

Run more than one command in a script

**tell** <span style="color: green;">tomboy</span> **to**
<span style="color: green;">FindStartHereNote</span>  

**tell** <span style="color: green;">tomboy</span> **to**
<span style="color: green;">displaynote</span> **with the result**

Call a command which returns something and then do something based on
that: Tomboy has no &#8220;show the Start Here note&#8221; function, but this does
it fine by getting a reference to the Start Here note and then
displaying it. The latter command could also have been written as
`tell tomboy to displaynote it` or
`tell tomboy to displaynote FindStartHereNote`

**wait for** <span style="color: green;">banshee</span>&#8216;s
<span style="color: green;">eventchanged</span> **ask**
<span style="color: green;">banshee</span> **for**
<span style="color: green;">currenturi</span>  

**tell** <span style="color: green;">tomboy</span> **to**
<span style="color: green;">createnote</span> **with it**

Wait for an application (Banshee) to send a signal (a song has stopped
playing or started), then when it happens ask for the value of a
property (the path to the currently-playing song), and finally call a
different app (Tomboy) to create a note with that path as its name. This
example will then exit: if you want to create a new note *every* time
the song changes, then `wait repeatedly for` the signal rather than just
`wait`ing for it.

Next, some musings:
&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;-

One thing that this has revealed to me is that there are quite a few
apps which I&#8217;d like to interact over D-Bus with which don&#8217;t provide an
<span class="caps">API</span> to do so. The glaringly obvious example here is Nautilus (and indeed
there is a bug requesting a D-Bus <span class="caps">API</span>), and a part (a small part) of why
I&#8217;ve built this is that if there&#8217;s an easy way to encourage people to
write little programs controlling their desktop then that will encourage
application developers to build APIs to their apps. Zenity doesn&#8217;t have
one either, which makes interaction from these little Linglish scripts a
bit difficult; I suppose I could build &#8220;display dialog&#8221; commands into
the language but that seems a bit off. On the other hand, one of the
advantages here is that there&#8217;s nothing stopping someone building a
thing which is *just* a D-Bus <span class="caps">API</span> and which then calls out to Zenity to
do the work. A second is that our D-Bus APIs are not necessarily
brilliant. Picking a silly example, if you want to find Tomboy&#8217;s version
using Linglish you have to `tell tomboy to version`, which sounds rather
stupid; it should be &#8220;ask tomboy for version&#8221;, but `Version()` is a
method rather than a property in Tomboy&#8217;s D-Bus <span class="caps">API</span>. (I&#8217;m not picking on
Tomboy here; they have a pretty comprehensive <span class="caps">API</span>, and I&#8217;ve been testing
and developing Linglish using primarily Tomboy and Banshee.) Linglish is
sort of designed with the conceit that methods are verbs, hence the
&#8220;tell someapp to dosomething&#8221; syntax, which sounds deeply weird if your
methods are not actually a verb. It&#8217;s also jolly hard to work out what
D-Bus APIs are actually available. Well, that&#8217;s not true: if you&#8217;re me,
or a hacker like me, then you can use J5&#8217;s fantastic D-Feet D-Bus
browser. I think this problem is best solved with tools used to create
the language rather than the language itself, although there&#8217;s more on
this in the future-development section below. There were plenty of
comments on the last post saying that this was a stupid idea and that it
made much more sense to have a syntax like `screensaver/lock` or
`screensaver.lock()` rather than `tell screensaver to lock`. I,
personally, do not agree with that. I&#8217;m not necessarily suggesting that
I&#8217;m right and they&#8217;re wrong, or that neophytes will indeed find my way
easier: just that this is an alternative way. If you think that Python
or Smalltalk or any one of a dozen others are a better approach, go for
it: I&#8217;m certainly not stopping you.  

Thirdly, questions about what it might do in the future and whether those things are a good idea:
&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;-

The original conception I had for this in my head is now basically done.
You can send commands to programs, you can tie programs together, you
can get info out of a program and print it out. It would be able to do
half the little scripty tasks I want to do on my desktop (assuming that
the APIs existed to do them, which they mostly do not). Here are future
things it could do, in rough order from small to big:

1.  Be cleverer about calling methods on applications with more than one
    object. At the moment you have to `tell banshee&#8217;s engine to pause`,
    because Banshee exports more than one object. Since only one of
    those objects actually *has* a Pause() method,
    `tell banshee to pause` makes more sense.
2.  Have Linglish be able to document an application.
    `ask linglish about tomboy` which then prints out Tomboy commands
    you could use by introspecting Tomboy&#8217;s D-Bus <span class="caps">API</span> would be pretty
    nice. One big problem with this is that for most apps they need to
    be running to find out what <span class="caps">API</span> they offer, so
    `ask linglish about banshee` would start it up.
3.  There are currently no control statements. This is a problem if you
    want to do anything even semi-complicated in a script, especially
    since the common approach to D-Bus signals in Linux apps seems to be
    to generate a `SomethingHasChanged` and then pass a `whatchanged`
    parameter; Banshee fires `StateChanged(&#8216;paused&#8217;)` and
    `StateChanged(&#8216;playing&#8217;)` rather than `Playing` and `Paused`
    signals. NetworkManager has something similar. It&#8217;s understandable
    why: you get one signal in a few different flavours rather than a
    multitude of signals. Inconvenient for this, though, because to vary
    what the script does based on a parameter you have to have an `if`
    statement (or something similar). I&#8217;ve been thinking about this: I
    do not want to build a proper language. If you want that, learn
    Python. But&#8230;maybe it needs control statements. I don&#8217;t know. I&#8217;m
    against it, but if this is useless without them then that&#8217;s a strong
    argument that the effort is not worth it.
4.  A script editor. This would allow people to write scripts without
    having to know the names of any of the functions you need to call &#8212;
    popup completions and the like. This is even more problematic than
    `ask linglish about whatever`, since there&#8217;s no way of saying &#8220;which
    apps in the world offer a D-Bus <span class="caps">API</span>?&#8221; &#8212; most apps do not install an
    activation file, which means they must be running for any script
    editor to even know they exist. It&#8217;s also a lot of work, although
    most of the heavy lifting is done by GtkSourceView.
5.  Packaging and stuff. If this is likely to be useful I should make
    .debs of it and so on and make it easy for people to install and
    everything.

And finally&#8230;
&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;

The overarching question: is doing more of this a good idea and worth
the effort? Your comments gratefully&nbsp;accepted.
		</div> <!--/#entry-content-->
		<ul class="neighbours-links">
		<li><a href="http://www.kryogenix.org/days/2009/02/08/linglish-or-some-thoughts-on-a-scripting-language-for-the-linux-desktop/">Previous post</a></li>
		<li><a href="http://www.kryogenix.org/days/2009/02/13/ie6s-backlash/">Next post</a></li>
		</ul>
	</div> <!--/#main-->
</div>  <!--/#post-->
<div id="webmentions">
<h4>More in the discussion (powered by <a href="http://indiewebcamp.com/Webmention">webmentions</a>)</h4>
	<ul><li>(no mentions, yet.)</li></ul>
<form id="wmform" method="POST" action="https://webmention.herokuapp.com/api/webmention">
	<label>Did you link to this post? Enter your page's URL:
	<input type="url" name="source"></label>
	<input type="hidden" name="target" value="http://www.kryogenix.org/days/2009/02/11/more-thoughts-on-linglish/">
	<input type="submit" value="Add link">
</form>
<script src="http://www.kryogenix.org/days/theme/live-webmentions.js"></script>
</div>

<p id="oldcomments"></p>
<script>
var aurl = '2009/02/11/more-thoughts-on-linglish/';
var parts = aurl.split('/');
if (parts[parts.length-1] === "") { parts = parts.slice(0, parts.length-1); }
var comurl = "/oldcomments/" + parts.join("-") + ".html";
var x = new XMLHttpRequest();
x.open("HEAD", comurl, true);
x.onreadystatechange = function() {
	if (x.readyState == 4) {
		if (x.status == 200) {
			document.getElementById("oldcomments").innerHTML = '<a href="' + comurl + '">See pre-2014 comments on this post</a>';
		}
	}
};
x.send();
</script>

		</div>
		
		<div id="footer">
			<p>Powered by <a href="http://pelican.readthedocs.org">Pelican</a>, theme by <a href="http://bunnyman.info">tBunnyMan</a>.</p>
				<script type="text/javascript">
					var _gaq = _gaq || [];
					_gaq.push(['_setAccount', 'UA-331575-1']);
					_gaq.push(['_trackPageview']);
					(function() {
						var ga = document.createElement('script'); 
						ga.type = 'text/javascript'; ga.async = true;
						ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
						var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
					})();

					// from https://paul.kinlan.me/detecting-injected-content/
					var detectInjection = function(knownHostsArray) {
						var requests = window.performance.getEntriesByType("resource");
						var unknownHosts = []; var knownHosts = {}; var foundHosts = {};
						for (var knownHost in knownHostsArray) {
							knownHosts[knownHostsArray[knownHost]] = true;
						}
						for (var requestIdx = 0; requestIdx < requests.length; requestIdx++) {
							var request = requests[requestIdx];
							var url = new URL(request.name);
							var host = url.host;
							// Aggregate all the requests from a host
							if(host in foundHosts) { foundHosts[host].push(request); } else { foundHosts[host] = new Array(request); }
						}
						for(var foundHost in foundHosts) {
							// If an unknown host is found, add it to a list.
							if(!(foundHost in knownHosts)) { unknownHosts.push(foundHost); }
						}
						return unknownHosts;
					};
					window.addEventListener("load", function() {
						var scripts = detectInjection(["kryogenix.org", "www.kryogenix.org", "www.google-analytics.com"]);
						if(!!scripts === true && scripts.length > 0) {
							for(var scriptsIdx = 0; scriptsIdx < scripts.length; scriptsIdx++) {
								var scr = scripts[scriptsIdx];
								_gaq.push(['trackEvent', 'ScriptLoads', 'UnknownHost', scr]);
							}
						}
					});
				</script>
		</div><!-- /#footer -->
	</div><!-- /#container -->
	<div style="display:none"></div>
</body>
</html>